stages:
  - deploy

deploy:
  stage: deploy
  tags:
    - shell
  before_script:
    - mkdir -p ~/.ssh
    - echo "$SSH_PRIVATE_KEY" | base64 -d > ~/.ssh/id_ed25519
    - chmod 600 ~/.ssh/id_ed25519
    - echo "Host deploy" >> ~/.ssh/config
    - echo "  HostName your-server-ip" >> ~/.ssh/config
    - echo "  User gitdeploy" >> ~/.ssh/config
  script:
    - ssh deploy "cd /var/www/wiimart.org && git pull && sudo systemctl reload httpd"